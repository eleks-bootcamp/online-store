function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _createForOfIteratorHelper(e,t){var n,r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return r&&(e=r),n=0,{s:t=function(){},n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cart=function(){function e(){_classCallCheck(this,e),_defineProperty(this,"items",{}),this.render(),this.getSubElements(),this.initEventListeners()}return _createClass(e,[{key:"template",get:function(){return'\n      <div class="cart-container">\n        <ul class="cart-list" data-element=\'list\'>\n\n        </ul>\n        <div class="footer">\n          <div class="cart-total">\n            Total: <span data-element="total">0</span>\n          </div>\n          <button class="order-btn os-btn-primary" data-element="orderBtn">Order</button>\n        </div>\n      </div>\n    '}},{key:"render",value:function(){var e=document.createElement("div");e.innerHTML=this.template,this.element=e.firstElementChild}},{key:"getSubElements",value:function(){var e,t={},n=_createForOfIteratorHelper(this.element.querySelectorAll("[data-element]"));try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r.dataset.element]=r}}catch(e){n.e(e)}finally{n.f()}this.subElements=t}},{key:"initEventListeners",value:function(){var i=this;this.element.addEventListener("pointerdown",function(e){var t,n,r,a=e.target.closest("[data-counter]");a&&(t=(e=e.target.closest('[data-element="counterContainer"]')).dataset.id,a=a.dataset.counter,r=(n=e.querySelector('[data-element="'.concat(t,'"]'))).innerText,r=parseInt(r,10)+parseInt(a,10),0<parseInt(a,10)?i.element.dispatchEvent(new CustomEvent("add-to-cart",{detail:i.items[t],bubbles:!0})):i.element.dispatchEvent(new CustomEvent("remove-from-cart",{bubbles:!0})),0===r?(delete i.items[t],e.remove()):(i.items[t].count=r,n.innerText=r,i.updatePrice(i.items[t])),i.updateTotal())})}},{key:"updatePrice",value:function(e){var t,n=this.element.querySelector('[data-id="'.concat(e.id,'"]'));n&&(t=n.querySelector('[data-element="price"]'),n=n.querySelector('[data-element="'.concat(e.id,'"]')),t.innerText=e.price*e.count,n.innerText=e.count)}},{key:"add",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this.items[e.id];t?(t.count+=1,this.updatePrice(t)):(t=_objectSpread(_objectSpread({},e),{},{count:1}),this.items[e.id]=t,e=this.renderItem(t),this.subElements.list.append(e)),this.updateTotal()}},{key:"updateTotal",value:function(){var n=this,e=Object.keys(this.items).reduce(function(e,t){return e+n.items[t].count*n.items[t].price},0);this.subElements.total.innerHTML=e}},{key:"renderItem",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=document.createElement("div"),e='\n      <li class="item-row" data-element="counterContainer" data-id="'.concat(e.id,'">\n        <div class="item-preview">\n          <img src="').concat(e.images[0],'" alt="').concat(e.title,'">\n        </div>\n        <div class="item-name">\n          ').concat(e.title,'\n        </div>\n        <div class="item-counter">\n          <button class="count-btn" data-counter="-1">\n            <i class="bi bi-dash-circle"></i>\n          </button>\n          <span data-element="').concat(e.id,'">').concat(e.count,'</span>\n          <button class="count-btn" data-counter="1">\n            <i class="bi bi-plus-circle"></i>\n          </button>\n        </div>\n        <div class="item-price" data-element="price">\n          ').concat(e.price*e.count,"\n        </div>\n      </li>\n    ");return t.innerHTML=e,t.firstElementChild}}]),e}();export{Cart as default};